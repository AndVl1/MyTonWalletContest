{"version":3,"file":"src_lib_rlottie_RLottie_ts.5cd0a0c8292efa021862.js","mappings":"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","sources":["webpack://mytonwallet/./src/lib/rlottie/RLottie.ts","webpack://mytonwallet/./src/util/cycleRestrict.ts","webpack://mytonwallet/./src/util/launchMediaWorkers.ts"],"sourcesContent":["import { animate } from '../../util/animation';\nimport cycleRestrict from '../../util/cycleRestrict';\nimport generateUniqueId from '../../util/generateUniqueId';\nimport launchMediaWorkers, { MAX_WORKERS } from '../../util/launchMediaWorkers';\nimport {\n  DPR, IS_ANDROID, IS_IOS, IS_SAFARI,\n} from '../../util/windowEnvironment';\nimport { requestMeasure, requestMutation } from '../fasterdom/fasterdom';\n\ninterface Params {\n  size: number;\n  noLoop?: boolean;\n  quality?: number;\n  isLowPriority?: boolean;\n  coords?: { x: number; y: number };\n}\n\nconst WAITING = Symbol('WAITING');\ntype Frame =\n  undefined\n  | typeof WAITING\n  | ImageBitmap;\n\nconst HIGH_PRIORITY_QUALITY = (IS_ANDROID || IS_IOS) ? 0.75 : 1;\nconst LOW_PRIORITY_QUALITY = IS_ANDROID ? 0.5 : 0.75;\nconst LOW_PRIORITY_QUALITY_SIZE_THRESHOLD = 24;\nconst HIGH_PRIORITY_CACHE_MODULO = IS_SAFARI ? 2 : 4;\nconst LOW_PRIORITY_CACHE_MODULO = 0;\n\nconst workers = launchMediaWorkers().map(({ connector }) => connector);\nconst instancesByRenderId = new Map<string, RLottie>();\n\nlet lastWorkerIndex = -1;\n\nclass RLottie {\n  // Config\n\n  private views = new Map<string, {\n    canvas: HTMLCanvasElement;\n    ctx: CanvasRenderingContext2D;\n    isLoaded?: boolean;\n    isPaused?: boolean;\n    isSharedCanvas?: boolean;\n    coords?: Params['coords'];\n    onLoad?: NoneToVoidFunction;\n  }>();\n\n  private imgSize!: number;\n\n  private imageData!: ImageData;\n\n  private msPerFrame = 1000 / 60;\n\n  private reduceFactor = 1;\n\n  private cacheModulo!: number;\n\n  private workerIndex!: number;\n\n  private frames: Frame[] = [];\n\n  private framesCount?: number;\n\n  // State\n\n  private isAnimating = false;\n\n  private isWaiting = true;\n\n  private isEnded = false;\n\n  private isDestroyed = false;\n\n  private isRendererInited = false;\n\n  private approxFrameIndex = 0;\n\n  private prevFrameIndex = -1;\n\n  private stopFrameIndex? = 0;\n\n  private speed = 1;\n\n  private direction: 1 | -1 = 1;\n\n  private lastRenderAt?: number;\n\n  static init(...args: ConstructorParameters<typeof RLottie>) {\n    const [\n      , canvas,\n      renderId,\n      params,\n      viewId = generateUniqueId(), ,\n      onLoad,\n    ] = args;\n    let instance = instancesByRenderId.get(renderId);\n\n    if (!instance) {\n      // eslint-disable-next-line prefer-rest-params\n      instance = new RLottie(...args);\n      instancesByRenderId.set(renderId, instance);\n    } else {\n      instance.addView(viewId, canvas, onLoad, params?.coords);\n    }\n\n    return instance;\n  }\n\n  constructor(\n    private tgsUrl: string,\n    private container: HTMLDivElement | HTMLCanvasElement,\n    private renderId: string,\n    private params: Params,\n    viewId: string = generateUniqueId(),\n    private customColor?: [number, number, number],\n    private onLoad?: NoneToVoidFunction | undefined,\n    private onEnded?: (isDestroyed?: boolean) => void,\n    private onLoop?: () => void,\n  ) {\n    this.addView(viewId, container, onLoad, params.coords);\n    this.initConfig();\n    this.initRenderer();\n  }\n\n  public removeView(viewId: string) {\n    const {\n      canvas, ctx, isSharedCanvas, coords,\n    } = this.views.get(viewId)!;\n\n    if (isSharedCanvas) {\n      ctx.clearRect(coords!.x, coords!.y, this.imgSize, this.imgSize);\n    } else {\n      canvas.remove();\n    }\n\n    this.views.delete(viewId);\n\n    if (!this.views.size) {\n      this.destroy();\n    }\n  }\n\n  isPlaying() {\n    return this.isAnimating || this.isWaiting;\n  }\n\n  play(forceRestart = false, viewId?: string) {\n    if (viewId) {\n      this.views.get(viewId)!.isPaused = false;\n    }\n\n    if (this.isEnded && forceRestart) {\n      this.approxFrameIndex = Math.floor(0);\n    }\n\n    this.stopFrameIndex = undefined;\n    this.direction = 1;\n    this.doPlay();\n  }\n\n  pause(viewId?: string) {\n    this.lastRenderAt = undefined;\n\n    if (viewId) {\n      this.views.get(viewId)!.isPaused = true;\n\n      const areAllContainersPaused = Array.from(this.views.values()).every(({ isPaused }) => isPaused);\n      if (!areAllContainersPaused) {\n        return;\n      }\n    }\n\n    if (this.isWaiting) {\n      this.stopFrameIndex = this.approxFrameIndex;\n    } else {\n      this.isAnimating = false;\n    }\n\n    if (!this.params.isLowPriority) {\n      this.frames = this.frames.map((frame, i) => {\n        if (i === this.prevFrameIndex) {\n          return frame;\n        } else {\n          if (frame && frame !== WAITING) {\n            frame.close();\n          }\n\n          return undefined;\n        }\n      });\n    }\n  }\n\n  playSegment([startFrameIndex, stopFrameIndex]: [number, number], forceRestart = false, viewId?: string) {\n    if (viewId) {\n      this.views.get(viewId)!.isPaused = false;\n    }\n\n    const frameIndex = Math.round(this.approxFrameIndex);\n    this.stopFrameIndex = Math.floor(stopFrameIndex / this.reduceFactor);\n    if (frameIndex !== stopFrameIndex || forceRestart) {\n      this.approxFrameIndex = Math.floor(startFrameIndex / this.reduceFactor);\n    }\n    this.direction = startFrameIndex < stopFrameIndex ? 1 : -1;\n\n    this.doPlay();\n  }\n\n  setSpeed(speed: number) {\n    this.speed = speed;\n  }\n\n  setNoLoop(noLoop?: boolean) {\n    this.params.noLoop = noLoop;\n  }\n\n  setSharedCanvasCoords(viewId: string, newCoords: Params['coords']) {\n    const containerInfo = this.views.get(viewId)!;\n    const {\n      canvas, ctx,\n    } = containerInfo;\n\n    let [canvasWidth, canvasHeight] = [canvas.width, canvas.height];\n\n    if (!canvas.dataset.isJustCleaned || canvas.dataset.isJustCleaned === 'false') {\n      const sizeFactor = this.calcSizeFactor();\n      ([canvasWidth, canvasHeight] = ensureCanvasSize(canvas, sizeFactor));\n      ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n      canvas.dataset.isJustCleaned = 'true';\n      requestMeasure(() => {\n        canvas.dataset.isJustCleaned = 'false';\n      });\n    }\n\n    containerInfo.coords = {\n      x: Math.round((newCoords?.x || 0) * canvasWidth),\n      y: Math.round((newCoords?.y || 0) * canvasHeight),\n    };\n\n    const frame = this.getFrame(this.prevFrameIndex) || this.getFrame(Math.round(this.approxFrameIndex));\n\n    if (frame && frame !== WAITING) {\n      ctx.drawImage(frame, containerInfo.coords!.x, containerInfo.coords!.y);\n    }\n  }\n\n  private addView(\n    viewId: string,\n    container: HTMLDivElement | HTMLCanvasElement,\n    onLoad?: NoneToVoidFunction,\n    coords?: Params['coords'],\n  ) {\n    const sizeFactor = this.calcSizeFactor();\n\n    let imgSize: number;\n\n    if (container instanceof HTMLDivElement) {\n      if (!(container.parentNode instanceof HTMLElement)) {\n        throw new Error('[RLottie] Container is not mounted');\n      }\n\n      const { size } = this.params;\n\n      imgSize = Math.round(size * sizeFactor);\n\n      if (!this.imgSize) {\n        this.imgSize = imgSize;\n        this.imageData = new ImageData(imgSize, imgSize);\n      }\n\n      requestMutation(() => {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d')!;\n\n        canvas.style.width = `${size}px`;\n        canvas.style.height = `${size}px`;\n\n        canvas.width = imgSize;\n        canvas.height = imgSize;\n\n        container.appendChild(canvas);\n\n        this.views.set(viewId, {\n          canvas, ctx, onLoad,\n        });\n      });\n    } else {\n      if (!container.isConnected) {\n        throw new Error('[RLottie] Shared canvas is not mounted');\n      }\n\n      const canvas = container;\n      const ctx = canvas.getContext('2d')!;\n\n      imgSize = Math.round(this.params.size * sizeFactor);\n\n      if (!this.imgSize) {\n        this.imgSize = imgSize;\n        this.imageData = new ImageData(imgSize, imgSize);\n      }\n\n      const [canvasWidth, canvasHeight] = ensureCanvasSize(canvas, sizeFactor);\n\n      this.views.set(viewId, {\n        canvas,\n        ctx,\n        isSharedCanvas: true,\n        coords: {\n          x: Math.round(coords!.x * canvasWidth),\n          y: Math.round(coords!.y * canvasHeight),\n        },\n        onLoad,\n      });\n    }\n\n    if (this.isRendererInited) {\n      this.doPlay();\n    }\n  }\n\n  private calcSizeFactor() {\n    const {\n      size,\n      isLowPriority,\n      // Reduced quality only looks acceptable on big enough images\n      quality = isLowPriority && (!size || size > LOW_PRIORITY_QUALITY_SIZE_THRESHOLD)\n        ? LOW_PRIORITY_QUALITY : HIGH_PRIORITY_QUALITY,\n    } = this.params;\n\n    // Reduced quality only looks acceptable on high DPR screens\n    return Math.max(DPR * quality, 1);\n  }\n\n  private destroy() {\n    this.isDestroyed = true;\n    this.pause();\n    this.clearCache();\n    this.destroyRenderer();\n\n    instancesByRenderId.delete(this.renderId);\n  }\n\n  private clearCache() {\n    this.frames.forEach((frame) => {\n      if (frame && frame !== WAITING) {\n        frame.close();\n      }\n    });\n\n    // Help GC\n    this.imageData = undefined as any;\n    this.frames = [];\n  }\n\n  private initConfig() {\n    const { isLowPriority } = this.params;\n\n    this.cacheModulo = isLowPriority ? LOW_PRIORITY_CACHE_MODULO : HIGH_PRIORITY_CACHE_MODULO;\n  }\n\n  setColor(newColor: [number, number, number] | undefined) {\n    this.customColor = newColor;\n  }\n\n  private initRenderer() {\n    this.workerIndex = cycleRestrict(MAX_WORKERS, ++lastWorkerIndex);\n\n    workers[this.workerIndex].request({\n      name: 'rlottie:init',\n      args: [\n        this.renderId,\n        this.tgsUrl,\n        this.imgSize,\n        this.params.isLowPriority || false,\n        this.customColor,\n        this.onRendererInit.bind(this),\n      ],\n    });\n  }\n\n  private destroyRenderer() {\n    workers[this.workerIndex].request({\n      name: 'rlottie:destroy',\n      args: [this.renderId],\n    });\n  }\n\n  private onRendererInit(reduceFactor: number, msPerFrame: number, framesCount: number) {\n    this.isRendererInited = true;\n    this.reduceFactor = reduceFactor;\n    this.msPerFrame = msPerFrame;\n    this.framesCount = framesCount;\n\n    if (this.isWaiting) {\n      this.doPlay();\n    }\n  }\n\n  changeData(tgsUrl: string) {\n    this.pause();\n    this.tgsUrl = tgsUrl;\n    this.initConfig();\n\n    workers[this.workerIndex].request({\n      name: 'rlottie:changeData',\n      args: [\n        this.renderId,\n        this.tgsUrl,\n        this.params.isLowPriority || false,\n        this.onChangeData.bind(this),\n      ],\n    });\n  }\n\n  private onChangeData(reduceFactor: number, msPerFrame: number, framesCount: number) {\n    this.reduceFactor = reduceFactor;\n    this.msPerFrame = msPerFrame;\n    this.framesCount = framesCount;\n    this.isWaiting = false;\n    this.isAnimating = false;\n\n    this.doPlay();\n  }\n\n  private doPlay() {\n    if (!this.framesCount) {\n      return;\n    }\n\n    if (this.isDestroyed) {\n      return;\n    }\n\n    if (this.isAnimating) {\n      return;\n    }\n\n    if (!this.isWaiting) {\n      this.lastRenderAt = undefined;\n    }\n\n    this.isEnded = false;\n    this.isAnimating = true;\n    this.isWaiting = false;\n\n    animate(() => {\n      if (this.isDestroyed) {\n        return false;\n      }\n\n      // Paused from outside\n      if (!this.isAnimating) {\n        const areAllLoaded = Array.from(this.views.values()).every(({ isLoaded }) => isLoaded);\n        if (areAllLoaded) {\n          return false;\n        }\n      }\n\n      const frameIndex = Math.round(this.approxFrameIndex);\n      const frame = this.getFrame(frameIndex);\n      if (!frame || frame === WAITING) {\n        if (!frame) {\n          this.requestFrame(frameIndex);\n        }\n\n        this.isAnimating = false;\n        this.isWaiting = true;\n        return false;\n      }\n\n      if (this.cacheModulo && frameIndex % this.cacheModulo === 0) {\n        this.cleanupPrevFrame(frameIndex);\n      }\n\n      if (frameIndex !== this.prevFrameIndex) {\n        this.views.forEach((containerData) => {\n          const {\n            ctx, isLoaded, isPaused, coords: { x, y } = {}, onLoad,\n          } = containerData;\n\n          if (!isLoaded || !isPaused) {\n            ctx.clearRect(x || 0, y || 0, this.imgSize, this.imgSize);\n            ctx.drawImage(frame, x || 0, y || 0);\n          }\n\n          if (!isLoaded) {\n            containerData.isLoaded = true;\n            onLoad?.();\n          }\n        });\n\n        this.prevFrameIndex = frameIndex;\n      }\n\n      const now = Date.now();\n      const currentSpeed = this.lastRenderAt ? this.msPerFrame / (now - this.lastRenderAt) : 1;\n      const delta = (this.direction * this.speed) / currentSpeed;\n      const expectedNextFrameIndex = Math.round(this.approxFrameIndex + delta);\n\n      this.lastRenderAt = now;\n\n      // Forward animation finished\n      if (delta > 0 && (frameIndex === this.framesCount! - 1 || expectedNextFrameIndex > this.framesCount! - 1)) {\n        if (this.params.noLoop) {\n          this.isAnimating = false;\n          this.isEnded = true;\n          this.onEnded?.();\n          return false;\n        }\n        this.onLoop?.();\n\n        this.approxFrameIndex = 0;\n\n        // Backward animation finished\n      } else if (delta < 0 && (frameIndex === 0 || expectedNextFrameIndex < 0)) {\n        if (this.params.noLoop) {\n          this.isAnimating = false;\n          this.isEnded = true;\n          this.onEnded?.();\n          return false;\n        }\n        this.onLoop?.();\n\n        this.approxFrameIndex = this.framesCount! - 1;\n\n        // Stop frame reached\n      } else if (\n        this.stopFrameIndex !== undefined\n        && (frameIndex === this.stopFrameIndex\n          || (\n            (delta > 0 && expectedNextFrameIndex > this.stopFrameIndex)\n            || (delta < 0 && expectedNextFrameIndex < this.stopFrameIndex)\n          ))\n      ) {\n        this.stopFrameIndex = undefined;\n        this.isAnimating = false;\n        return false;\n\n        // Preparing next frame\n      } else {\n        this.approxFrameIndex += delta;\n      }\n\n      const nextFrameIndex = Math.round(this.approxFrameIndex);\n\n      if (!this.getFrame(nextFrameIndex)) {\n        this.requestFrame(nextFrameIndex);\n        this.isWaiting = true;\n        this.isAnimating = false;\n        return false;\n      }\n\n      return true;\n    }, requestMutation);\n  }\n\n  private getFrame(frameIndex: number) {\n    return this.frames[frameIndex];\n  }\n\n  private requestFrame(frameIndex: number) {\n    this.frames[frameIndex] = WAITING;\n\n    workers[this.workerIndex].request({\n      name: 'rlottie:renderFrames',\n      args: [this.renderId, frameIndex, this.onFrameLoad.bind(this)],\n    });\n  }\n\n  private cleanupPrevFrame(frameIndex: number) {\n    if (this.framesCount! < 3) {\n      return;\n    }\n\n    const prevFrameIndex = cycleRestrict(this.framesCount!, frameIndex - 1);\n    this.frames[prevFrameIndex] = undefined;\n  }\n\n  private onFrameLoad(frameIndex: number, imageBitmap: ImageBitmap) {\n    if (this.frames[frameIndex] !== WAITING) {\n      return;\n    }\n\n    this.frames[frameIndex] = imageBitmap;\n\n    if (this.isWaiting) {\n      this.doPlay();\n    }\n  }\n}\n\nfunction ensureCanvasSize(canvas: HTMLCanvasElement, sizeFactor: number) {\n  const expectedWidth = Math.round(canvas.offsetWidth * sizeFactor);\n  const expectedHeight = Math.round(canvas.offsetHeight * sizeFactor);\n\n  if (canvas.width !== expectedWidth || canvas.height !== expectedHeight) {\n    requestMutation(() => {\n      canvas.width = expectedWidth;\n      canvas.height = expectedHeight;\n    });\n  }\n\n  return [expectedWidth, expectedHeight];\n}\n\nexport default RLottie;\n","export default function cycleRestrict(length: number, index: number) {\n  return index - Math.floor(index / length) * length;\n}\n","import type { MediaWorkerApi } from '../lib/mediaWorker/index.worker';\nimport type { Connector } from './PostMessageConnector';\n\nimport { IS_TEST } from '../config';\n\nimport { createConnector } from './PostMessageConnector';\n\nexport const MAX_WORKERS = Math.min(navigator.hardwareConcurrency || 4, 4);\n\nlet instances: {\n  worker: Worker;\n  connector: Connector<MediaWorkerApi>;\n}[] | undefined;\n\nexport default function launchMediaWorkers() {\n  if (IS_TEST) return [];\n  if (!instances) {\n    instances = new Array(MAX_WORKERS).fill(undefined).map(\n      () => {\n        const worker = new Worker(new URL('../lib/mediaWorker/index.worker.ts', import.meta.url));\n        const connector = createConnector<MediaWorkerApi>(worker);\n        return { worker, connector };\n      },\n    );\n  }\n\n  return instances;\n}\n"],"names":["animate","cycleRestrict","generateUniqueId","launchMediaWorkers","MAX_WORKERS","DPR","IS_ANDROID","IS_IOS","IS_SAFARI","requestMeasure","requestMutation","WAITING","Symbol","HIGH_PRIORITY_QUALITY","LOW_PRIORITY_QUALITY","LOW_PRIORITY_QUALITY_SIZE_THRESHOLD","HIGH_PRIORITY_CACHE_MODULO","LOW_PRIORITY_CACHE_MODULO","workers","map","_ref","connector","instancesByRenderId","Map","lastWorkerIndex","RLottie","init","_len","arguments","length","args","Array","_key","canvas","renderId","params","viewId","onLoad","instance","get","set","addView","coords","constructor","tgsUrl","container","undefined","customColor","onEnded","onLoop","_defineProperty","initConfig","initRenderer","removeView","ctx","isSharedCanvas","views","clearRect","x","y","imgSize","remove","delete","size","destroy","isPlaying","isAnimating","isWaiting","play","forceRestart","isPaused","isEnded","approxFrameIndex","Math","floor","stopFrameIndex","direction","doPlay","pause","lastRenderAt","areAllContainersPaused","from","values","every","_ref2","isLowPriority","frames","frame","i","prevFrameIndex","close","playSegment","_ref3","startFrameIndex","frameIndex","round","reduceFactor","setSpeed","speed","setNoLoop","noLoop","setSharedCanvasCoords","newCoords","containerInfo","canvasWidth","canvasHeight","width","height","dataset","isJustCleaned","sizeFactor","calcSizeFactor","ensureCanvasSize","getFrame","drawImage","HTMLDivElement","parentNode","HTMLElement","Error","imageData","ImageData","document","createElement","getContext","style","appendChild","isConnected","isRendererInited","quality","max","isDestroyed","clearCache","destroyRenderer","forEach","cacheModulo","setColor","newColor","workerIndex","request","name","onRendererInit","bind","msPerFrame","framesCount","changeData","onChangeData","areAllLoaded","_ref4","isLoaded","requestFrame","cleanupPrevFrame","containerData","now","Date","currentSpeed","delta","expectedNextFrameIndex","_this$onLoop","_this$onEnded","call","_this$onLoop2","_this$onEnded2","nextFrameIndex","onFrameLoad","imageBitmap","expectedWidth","offsetWidth","expectedHeight","offsetHeight","index","IS_TEST","createConnector","min","navigator","hardwareConcurrency","instances","fill","worker","Worker","URL","import","meta","url"],"sourceRoot":""}